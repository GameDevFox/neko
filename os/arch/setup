# Link timezone
ln -fs /usr/share/zoneinfo/America/Los_Angeles /etc/localtime

# Generate locale
sed -i '/^#en_US\.UTF-8 UTF-8/ s/#//' /etc/locale.gen
locale-gen
echo LANG=en_US.UTF-8 > /etc/locale.conf

# Make init ram disk
mkinitcpio -p linux

# setup fox user
useradd -m -s /usr/bin/zsh -u 10000 fox

# add user `fox` to group `wheel`
usermod -aG wheel fox

# add wheel rule to sudoers.d
echo "%wheel ALL=(ALL) ALL" > /etc/sudoers.d/wheel

# Get git so we can clone royal-neko
pacman --noconfirm -S git

# royal-neko setup
if [ ! -d /home/fox/royal-neko ]; then
  pushd ~fox
    sudo -u fox git clone https://Prince86EKNJ@github.com/Prince86EKNJ/royal-neko

    # Run royal-neko install script
    sudo -u fox royal-neko/bin/link-neko
  popd
fi

# get package list from royal-neko
archPackages=$(cat ~fox/royal-neko/os/arch/packages | grep -v "^#")
pacman --noconfirm --needed -S ${archPackages}

# create projects directory
mkdir $HOME/projects

# Finished it off with a password
passwd fox

# Disable root login (lock password)
passwd root -l
